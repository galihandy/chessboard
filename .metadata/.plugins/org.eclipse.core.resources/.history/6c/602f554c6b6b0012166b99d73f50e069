package com.flipbox.myevent;

import java.util.ArrayList;
import java.util.HashMap;

import org.json.JSONArray;

import android.app.ListActivity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.ArrayAdapter;
import android.widget.ListView;

public class SavedEventActivity extends ListActivity {

	private ArrayList<Event> eventList;
	private String[] keys;

	@Override
	public void onCreate(Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);
		setContentView(R.layout.saved_item);
		setKeys();

		eventList = Database.getMyEventList();

		SavedEventAdapter adapter = new SavedEventAdapter(getBaseContext(),
				R.layout.list_feature_item, eventList);
		setListAdapter(adapter);
	}

	@Override
	protected void onListItemClick(ListView l, View v, int position, long id) {

		super.onListItemClick(l, v, position, id);

		Event e = (Event) l.getSelectedItem();

		Intent in = new Intent(getBaseContext(), DetailEventActivity.class);
		HashMap<String, Object> eventMap = eventToHashMap(e); 
		for (int i = 0; i < GeneralUtilities.KEYS.length; i++) {
			String key = GeneralUtilities.KEYS[i];
			String extra = (String) eventMap.get(key);
			in.putExtra(key, extra);
		}
	}

	private HashMap<String, Object> eventToHashMap(Event e) {
		HashMap<String, Object> map = new HashMap<String, Object>();

		map.put(Database.EVENT_AUTHOR, e.getAuthor());
		map.put(Database.EVENT_CAT, e.getCategory());
		map.put(Database.EVENT_CONTACT, e.getContact());
		map.put(Database.EVENT_DATE_CREATED, e.getDateCreated());
		map.put(Database.EVENT_DATE_PUBLISHED, e.getDatePublished());
		map.put(Database.EVENT_DESC, e.getDesc());
		map.put(Database.EVENT_END_DATE, e.getEndDate());
		map.put(Database.EVENT_ID, e.getId());
		map.put(Database.EVENT_IMG_URL, e.getImageUrl());
		map.put(Database.EVENT_LATD, e.getLatitude());
		map.put(Database.EVENT_LONGTD, e.getLongitude());
		map.put(Database.EVENT_LOC, e.getLocation());
		map.put(Database.EVENT_NAME, e.getName());
		map.put(Database.EVENT_START_DATE, e.getStartDate());
		map.put(Database.EVENT_TICKET_PRC, e.getTicketPrice());

		return map;
	}
}
