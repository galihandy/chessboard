package com.flipbox.myevent;

import twitter4j.Twitter;
import twitter4j.TwitterException;
import twitter4j.TwitterFactory;
import twitter4j.conf.Configuration;
import twitter4j.conf.ConfigurationBuilder;
import android.app.Activity;
import android.os.AsyncTask;
import android.os.Bundle;
import android.widget.ListView;

public class TwitterActivity extends Activity {

	// myevent key
	public static final String CONSUMMER_KEY = "LevFBVy7W1ifUCOS4HpoKA";
	public static final String CONSUMMER_SECRET = "2FYoBybVDzFZmCoV41EBoH9TQJsPTtqSqrdohyohA";

	// flipbox key
	public static final String ACCESS_TOKEN = "328403521-zUovsGFExGBG5LXlVLnAivWrF4FYR7PMbQnmxAbx";
	public static final String ACCESS_SECRET = "CBJFXg4NvmZA2fUKILWYJ5RwUF91iGlLlJOFEFPnnM";

	private ListView tweetListLv;

	@Override
	protected void onCreate(Bundle savedInstanceState) {

		super.onCreate(savedInstanceState);
		setContentView(R.layout.multiview);
		tweetListLv = (ListView) findViewById(R.id.tweet_listview);
		loadTwitter();

	}

	private void loadTwitter() {
		new AsyncTask<Object, Object, Object>() {

			@Override
			protected Object doInBackground(Object... params) {

				// configure authentication to twitter api with flipbox account
				ConfigurationBuilder confBuilder = new ConfigurationBuilder();
				confBuilder.setOAuthConsumerKey(CONSUMMER_KEY)
						.setOAuthConsumerSecret(CONSUMMER_SECRET)
						.setOAuthAccessToken(ACCESS_TOKEN)
						.setOAuthAccessTokenSecret(ACCESS_SECRET);
				Configuration conf = confBuilder.build();

				// make twitter object with above configuration.
				Twitter twitter = new TwitterFactory(conf).getInstance();
				try {
					TwitterAdapter adapter = new TwitterAdapter(
							TwitterActivity.this, twitter.getUserTimeline());
					tweetListLv.setAdapter(adapter);

				} catch (TwitterException e) {
					e.printStackTrace();
				}

				return null;
			}

			@Override
			protected void onPostExecute(Object result) {
				super.onPostExecute(result);
			}
		};
	}

}
